<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>HSSModel.jl Documentation · HSSModel</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">HSSModel</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>HSSModel.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Basic-Walkthrough"><span>Basic Walkthrough</span></a></li><li><a class="tocitem" href="#Running-an-ensemble"><span>Running an ensemble</span></a></li></ul></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>HSSModel.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>HSSModel.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com//blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="HSSModel.jl-Documentation"><a class="docs-heading-anchor" href="#HSSModel.jl-Documentation">HSSModel.jl Documentation</a><a id="HSSModel.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#HSSModel.jl-Documentation" title="Permalink"></a></h1><p>HSSModel implements a basic NOx-HOx steady state model that can be used to compute NOx lifetime, ozone production efficency, and other quantities for theoretical conditions.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Currently, this package is only available to install from GitHub. From the Julia REPL:</p><pre><code class="language-none">julia&gt; ]add https://github.com/joshua-laughner/HSSModel.git</code></pre><p>Since this will track the <code>master</code> branch, you may also wish to pin this package  so that it does not update until you want it to:</p><pre><code class="language-none">julia&gt; ]pin HSSModel</code></pre><h2 id="Basic-Walkthrough"><a class="docs-heading-anchor" href="#Basic-Walkthrough">Basic Walkthrough</a><a id="Basic-Walkthrough-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Walkthrough" title="Permalink"></a></h2><p>Importing <code>HSSModel</code> exposes the main driver function, <code>hox_ss_solver</code> from the <code>SteadyStateSolvers</code> module. This function requires 5 inputs:</p><ol><li>NO concentration (in molec. cm<span>$^{-3}$</span>)</li><li>NO2 concentration (in molec. cm<span>$^{-3}$</span>)</li><li>HOx production rate (in molec. cm<span>$^{-3}$</span> s<span>$^{-1}$</span>)</li><li>Total VOC reactivity (in s<span>$^{-1}$</span>)</li><li>The NO + RO2 branching ratio, <span>$\alpha$</span> (unitless).</li></ol><p>For this example, we&#39;ll be using values from Table 4 of  <a href="https://acp.copernicus.org/preprints/6/11971/2006/acpd-6-11971-2006.pdf">Murphy et al. 2006</a> for P(HOx), VOC reactivity, and <span>$\alpha$</span>, plus we will assume 5 ppb of NOx. Since our inputs need to be in number density, rather than mixing ratio, we&#39;ll need the number density of air to convert.</p><pre><code class="language-julia"># gas constant in Pa cm^3 K^-1 molec^-1
R = 8.314 * 1e6 / 6.022e23

# number density of air at STP
nair = 101325 / (R * 298)

# Convert from NOx in ppb to NO and NO2 in molec. cm^-3
# assuming a 4:1 NO2:NO ratio
nox_ppb = 5;
no_nd = nox_ppb*1e-9 * 0.2 * nair;
no2_nd = nox_ppb*1e-9 * 0.8 * nair;

# Other default values from Murphy et al. 2006
phox = 2.5e-9 * nair / 3600;  # convert ppb hr^-1 -&gt; molec. cm^-3 s^-1
vocr = 5.8;
alpha = 0.04;</code></pre><p>With these conditions, we call the steady state solver, which will compute the steady state concentrations of OH, HO2, and RO2 given these fixed values.</p><pre><code class="language-julia">using HSSModel;
result = hox_ss_solver(no_nd, no2_nd, phox, vocr, alpha);

println(&quot;OH = $(result.oh), HO2 = $(result.ho2), RO2 = $(result.ro2)&quot;);</code></pre><pre class="documenter-example-output">OH = 1.3288062945776744e7, HO2 = 3.555827622868582e8, RO2 = 3.8550423326615673e8</pre><p>This result structure contains information about the steady state concentrations, as well as the model configuration. Generally, most information you would need to plot the model results is contained in this structure. </p><p>These result structure can also be use to calculate secondary quantities. The <code>DerivedQuantities</code> module exports two functions to do so: <code>nox_lifetime</code> and <code>ozone_production_efficiency</code>. Calling these with your results produces:</p><pre><code class="language-julia">nox_lifetime(result)</code></pre><pre class="documenter-example-output">Dict{String,Float64} with 3 entries:
  &quot;total&quot; =&gt; 1.96583
  &quot;hno3&quot;  =&gt; 2.37549
  &quot;ans&quot;   =&gt; 11.3992</pre><p>This returns a dictionary with three different lifetimes, in hours:</p><ul><li><code>total</code> is the overall NOx lifetime.</li><li><code>hno3</code> is the lifetime with respect to loss to HNO3</li><li><code>ans</code> is the lifetime with respect to loss to alkyl nitrates</li></ul><pre><code class="language-julia">ozone_prod_efficiency(result)</code></pre><pre class="documenter-example-output">10.279835377647869</pre><p>Unlike <code>nox_lifetime</code>, this returns a single value. This represents the ratio of ozone production to NOx loss.</p><h2 id="Running-an-ensemble"><a class="docs-heading-anchor" href="#Running-an-ensemble">Running an ensemble</a><a id="Running-an-ensemble-1"></a><a class="docs-heading-anchor-permalink" href="#Running-an-ensemble" title="Permalink"></a></h2><p>The steady state model function works well with Julia&#39;s built in  broadcasting behavior. For a simple example, let&#39;s look at running a range of NOx concentrations:</p><pre><code class="language-julia"># Compute NO and NO2 number densities for logarithmically-spaced
# NOx mixing ratios between 0.01 and 10 ppb, still assuming a
# 4:1 NO2:NO ratio.
nox_nd = exp10.(range(-2., stop=1., length=20)) .* 1e-9 .* nair;
no2_nd = 0.8 .* nox_nd;
no_nd = 0.2 .* nox_nd;

# Note the broadcasting operator (the period following `hox_ss_solver`)
results = hox_ss_solver.(no_nd, no2_nd, phox, vocr, alpha);
size(results)</code></pre><pre class="documenter-example-output">(20,)</pre><p>If you want to test an ensemble with multiple variables, you can  use broadcasting in multiple dimensions. In this example, we&#39;ll use the same NOx vector (a 1D, 75 element vector) along with a vector of VOC reactivity values. By making the VOCR values a row (1-by-<span>$N$</span>) vector, the broadcasting will result in a  2D array of results.</p><pre><code class="language-julia"># Create a 1-by-10 vector of VOC reactivities
vocr_vec = collect(transpose(range(1., stop=10., length=10)));
results = hox_ss_solver.(no_nd, no2_nd, phox, vocr_vec, alpha);
size(results)</code></pre><pre class="documenter-example-output">(20, 10)</pre><p>A useful trick for quickly extracting values from these results arrays (for plotting or downstread analysis) is to broadcast the <code>getfield</code> function:</p><pre><code class="language-julia">getfield.(results, :oh)</code></pre><pre class="documenter-example-output">20×10 Array{Float64,2}:
 1.70933e7  8.55371e6  5.70404e6  …  2.13975e6  1.90204e6  1.71187e6
 1.71007e7  8.56047e6  5.70923e6     2.14202e6  1.90408e6  1.71372e6
 1.7123e7   8.5761e6   5.72065e6     2.14677e6  1.90833e6  1.71756e6
 1.71781e7  8.6101e6   5.74476e6     2.15649e6  1.91701e6  1.7254e6 
 1.72999e7  8.6804e6   5.79374e6     2.17585e6  1.93428e6  1.74098e6
 1.7547e7   8.81798e6  5.88861e6  …  2.21291e6  1.96731e6  1.77078e6
 1.80091e7  9.07057e6  6.06186e6     2.28018e6  2.02724e6  1.82481e6
 1.88068e7  9.50386e6  6.35855e6     2.39515e6  2.12966e6  1.91715e6
 2.00859e7  1.02016e7  6.83704e6     2.58095e6  2.29519e6  2.06641e6
 2.20083e7  1.12664e7  7.57094e6     2.86772e6  2.5508e6   2.29696e6
 2.47215e7  1.28168e7  8.65044e6  …  3.29486e6  2.93183e6  2.64086e6
 2.82704e7  1.49677e7  1.01764e7     3.91265e6  3.48376e6  3.13961e6
 3.23832e7  1.77659e7  1.22325e7     4.78088e6  4.26158e6  3.84403e6
 3.60763e7  2.10258e7  1.48023e7     5.95756e6  5.32119e6  4.80761e6
 3.73347e7  2.40196e7  1.75806e7     7.46232e6  6.69014e6  6.06262e6
 3.41351e7  2.52282e7  1.96835e7  …  9.18573e6  8.29248e6  7.55685e6
 2.73379e7  2.3181e7   1.96983e7     1.07277e7  9.80613e6  9.02775e6
 2.01573e7  1.86061e7  1.70493e7     1.13205e7  1.05569e7  9.88305e6
 1.43693e7  1.3774e7   1.31629e7     1.03748e7  9.90906e6  9.47509e6
 1.01194e7  9.86258e6  9.60545e6     8.37773e6  8.15128e6  7.93244e6</pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 16 June 2021 12:30">Wednesday 16 June 2021</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
